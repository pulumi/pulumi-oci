// *** WARNING: this file was generated by the Pulumi Terraform Bridge (tfgen) Tool. ***
// *** Do not edit by hand unless you're certain you know what you are doing! ***

using System;
using System.Collections.Generic;
using System.Collections.Immutable;
using System.Threading.Tasks;
using Pulumi.Serialization;

namespace Pulumi.Oci.Waas
{
    /// <summary>
    /// This resource provides the Protection Rule resource in Oracle Cloud Infrastructure Web Application Acceleration and Security service.
    /// 
    /// Updates the action for each specified protection rule. Requests can either be allowed, blocked, or trigger an alert if they meet the parameters of an applied rule. For more information on protection rules, see [WAF Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/Tasks/wafprotectionrules.htm).
    /// This operation can update or disable protection rules depending on the structure of the request body.
    /// Protection rules can be updated by changing the properties of the protection rule object with the rule's key specified in the key field.
    /// 
    /// ## Import
    /// 
    /// ProtectionRules can be imported using the `id`, e.g.
    /// 
    /// ```sh
    ///  $ pulumi import oci:Waas/protectionRule:ProtectionRule test_protection_rule "waasPolicyId/{waasPolicyId}/key/{key}"
    /// ```
    /// </summary>
    [OciResourceType("oci:Waas/protectionRule:ProtectionRule")]
    public partial class ProtectionRule : global::Pulumi.CustomResource
    {
        /// <summary>
        /// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
        /// </summary>
        [Output("action")]
        public Output<string?> Action { get; private set; } = null!;

        /// <summary>
        /// The description of the protection rule.
        /// </summary>
        [Output("description")]
        public Output<string?> Description { get; private set; } = null!;

        /// <summary>
        /// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
        /// </summary>
        [Output("exclusions")]
        public Output<ImmutableArray<Outputs.ProtectionRuleExclusion>> Exclusions { get; private set; } = null!;

        /// <summary>
        /// (Updatable) The unique key of the protection rule.
        /// </summary>
        [Output("key")]
        public Output<string> Key { get; private set; } = null!;

        /// <summary>
        /// The list of labels for the protection rule.
        /// </summary>
        [Output("labels")]
        public Output<ImmutableArray<string>> Labels { get; private set; } = null!;

        /// <summary>
        /// The list of the ModSecurity rule IDs that apply to this protection rule. For more information about ModSecurity's open source WAF rules, see [Mod Security's documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
        /// </summary>
        [Output("modSecurityRuleIds")]
        public Output<ImmutableArray<string>> ModSecurityRuleIds { get; private set; } = null!;

        /// <summary>
        /// The name of the protection rule.
        /// </summary>
        [Output("name")]
        public Output<string?> Name { get; private set; } = null!;

        /// <summary>
        /// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
        /// </summary>
        [Output("waasPolicyId")]
        public Output<string> WaasPolicyId { get; private set; } = null!;


        /// <summary>
        /// Create a ProtectionRule resource with the given unique name, arguments, and options.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resource</param>
        /// <param name="args">The arguments used to populate this resource's properties</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public ProtectionRule(string name, ProtectionRuleArgs args, CustomResourceOptions? options = null)
            : base("oci:Waas/protectionRule:ProtectionRule", name, args ?? new ProtectionRuleArgs(), MakeResourceOptions(options, ""))
        {
        }

        private ProtectionRule(string name, Input<string> id, ProtectionRuleState? state = null, CustomResourceOptions? options = null)
            : base("oci:Waas/protectionRule:ProtectionRule", name, state, MakeResourceOptions(options, id))
        {
        }

        private static CustomResourceOptions MakeResourceOptions(CustomResourceOptions? options, Input<string>? id)
        {
            var defaultOptions = new CustomResourceOptions
            {
                Version = Utilities.Version,
            };
            var merged = CustomResourceOptions.Merge(defaultOptions, options);
            // Override the ID if one was specified for consistency with other language SDKs.
            merged.Id = id ?? merged.Id;
            return merged;
        }
        /// <summary>
        /// Get an existing ProtectionRule resource's state with the given name, ID, and optional extra
        /// properties used to qualify the lookup.
        /// </summary>
        ///
        /// <param name="name">The unique name of the resulting resource.</param>
        /// <param name="id">The unique provider ID of the resource to lookup.</param>
        /// <param name="state">Any extra arguments used during the lookup.</param>
        /// <param name="options">A bag of options that control this resource's behavior</param>
        public static ProtectionRule Get(string name, Input<string> id, ProtectionRuleState? state = null, CustomResourceOptions? options = null)
        {
            return new ProtectionRule(name, id, state, options);
        }
    }

    public sealed class ProtectionRuleArgs : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
        /// </summary>
        [Input("action")]
        public Input<string>? Action { get; set; }

        [Input("exclusions")]
        private InputList<Inputs.ProtectionRuleExclusionArgs>? _exclusions;

        /// <summary>
        /// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
        /// </summary>
        public InputList<Inputs.ProtectionRuleExclusionArgs> Exclusions
        {
            get => _exclusions ?? (_exclusions = new InputList<Inputs.ProtectionRuleExclusionArgs>());
            set => _exclusions = value;
        }

        /// <summary>
        /// (Updatable) The unique key of the protection rule.
        /// </summary>
        [Input("key", required: true)]
        public Input<string> Key { get; set; } = null!;

        /// <summary>
        /// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
        /// </summary>
        [Input("waasPolicyId", required: true)]
        public Input<string> WaasPolicyId { get; set; } = null!;

        public ProtectionRuleArgs()
        {
        }
        public static new ProtectionRuleArgs Empty => new ProtectionRuleArgs();
    }

    public sealed class ProtectionRuleState : global::Pulumi.ResourceArgs
    {
        /// <summary>
        /// (Updatable) The action to take when the traffic is detected as malicious. If unspecified, defaults to `OFF`.
        /// </summary>
        [Input("action")]
        public Input<string>? Action { get; set; }

        /// <summary>
        /// The description of the protection rule.
        /// </summary>
        [Input("description")]
        public Input<string>? Description { get; set; }

        [Input("exclusions")]
        private InputList<Inputs.ProtectionRuleExclusionGetArgs>? _exclusions;

        /// <summary>
        /// An array of The target property of a request that would allow it to bypass the protection rule. For example, when `target` is `REQUEST_COOKIE_NAMES`, the list may include names of cookies to exclude from the protection rule. When the target is `ARGS`, the list may include strings of URL query parameters and values from form-urlencoded XML, JSON, AMP, or POST payloads to exclude from the protection rule. `Exclusions` properties must not contain whitespace, comma or |. **Note:** If protection rules have been enabled that utilize the `maxArgumentCount` or `maxTotalNameLengthOfArguments` properties, and the `target` property has been set to `ARGS`, it is important that the `exclusions` properties be defined to honor those protection rule settings in a consistent manner.
        /// </summary>
        public InputList<Inputs.ProtectionRuleExclusionGetArgs> Exclusions
        {
            get => _exclusions ?? (_exclusions = new InputList<Inputs.ProtectionRuleExclusionGetArgs>());
            set => _exclusions = value;
        }

        /// <summary>
        /// (Updatable) The unique key of the protection rule.
        /// </summary>
        [Input("key")]
        public Input<string>? Key { get; set; }

        [Input("labels")]
        private InputList<string>? _labels;

        /// <summary>
        /// The list of labels for the protection rule.
        /// </summary>
        public InputList<string> Labels
        {
            get => _labels ?? (_labels = new InputList<string>());
            set => _labels = value;
        }

        [Input("modSecurityRuleIds")]
        private InputList<string>? _modSecurityRuleIds;

        /// <summary>
        /// The list of the ModSecurity rule IDs that apply to this protection rule. For more information about ModSecurity's open source WAF rules, see [Mod Security's documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
        /// </summary>
        public InputList<string> ModSecurityRuleIds
        {
            get => _modSecurityRuleIds ?? (_modSecurityRuleIds = new InputList<string>());
            set => _modSecurityRuleIds = value;
        }

        /// <summary>
        /// The name of the protection rule.
        /// </summary>
        [Input("name")]
        public Input<string>? Name { get; set; }

        /// <summary>
        /// The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the WAAS policy.
        /// </summary>
        [Input("waasPolicyId")]
        public Input<string>? WaasPolicyId { get; set; }

        public ProtectionRuleState()
        {
        }
        public static new ProtectionRuleState Empty => new ProtectionRuleState();
    }
}
