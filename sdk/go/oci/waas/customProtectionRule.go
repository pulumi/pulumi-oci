// Code generated by the Pulumi Terraform Bridge (tfgen) Tool DO NOT EDIT.
// *** WARNING: Do not edit by hand unless you're certain you know what you are doing! ***

package waas

import (
	"context"
	"reflect"

	"errors"
	"github.com/pulumi/pulumi-oci/sdk/go/oci/internal"
	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
)

// This resource provides the Custom Protection Rule resource in Oracle Cloud Infrastructure Web Application Acceleration and Security service.
//
// Creates a new custom protection rule in the specified compartment.
//
// Custom protection rules allow you to create rules in addition to the rulesets provided by the Web Application Firewall service, including rules from [ModSecurity](https://modsecurity.org/). The syntax for custom rules is based on the ModSecurity syntax. For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/Tasks/customprotectionrules.htm).
//
// ## Example Usage
//
// ```go
// package main
//
// import (
//
//	"github.com/pulumi/pulumi-oci/sdk/go/oci/Waas"
//	"github.com/pulumi/pulumi/sdk/v3/go/pulumi"
//
// )
//
//	func main() {
//		pulumi.Run(func(ctx *pulumi.Context) error {
//			_, err := Waas.NewCustomProtectionRule(ctx, "testCustomProtectionRule", &Waas.CustomProtectionRuleArgs{
//				CompartmentId: pulumi.Any(_var.Compartment_id),
//				DisplayName:   pulumi.Any(_var.Custom_protection_rule_display_name),
//				Template:      pulumi.Any(_var.Custom_protection_rule_template),
//				DefinedTags: pulumi.Map{
//					"Operations.CostCenter": pulumi.Any("42"),
//				},
//				Description: pulumi.Any(_var.Custom_protection_rule_description),
//				FreeformTags: pulumi.Map{
//					"Department": pulumi.Any("Finance"),
//				},
//			})
//			if err != nil {
//				return err
//			}
//			return nil
//		})
//	}
//
// ```
//
// ## Import
//
// CustomProtectionRules can be imported using the `id`, e.g.
//
// ```sh
//
//	$ pulumi import oci:Waas/customProtectionRule:CustomProtectionRule test_custom_protection_rule "id"
//
// ```
type CustomProtectionRule struct {
	pulumi.CustomResourceState

	// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
	CompartmentId pulumi.StringOutput `pulumi:"compartmentId"`
	// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
	DefinedTags pulumi.MapOutput `pulumi:"definedTags"`
	// (Updatable) A description for the Custom Protection rule.
	Description pulumi.StringOutput `pulumi:"description"`
	// (Updatable) A user-friendly name for the custom protection rule.
	DisplayName pulumi.StringOutput `pulumi:"displayName"`
	// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
	FreeformTags pulumi.MapOutput `pulumi:"freeformTags"`
	// The auto-generated ID for the custom protection rule. These IDs are referenced in logs.
	ModSecurityRuleIds pulumi.StringArrayOutput `pulumi:"modSecurityRuleIds"`
	// The current lifecycle state of the custom protection rule.
	State pulumi.StringOutput `pulumi:"state"`
	// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
	//
	// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
	//
	// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
	//
	// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
	//
	// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
	//
	// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
	//
	// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
	//
	// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
	//
	// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	//
	// ** IMPORTANT **
	// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
	Template pulumi.StringOutput `pulumi:"template"`
	// The date and time the protection rule was created, expressed in RFC 3339 timestamp format.
	TimeCreated pulumi.StringOutput `pulumi:"timeCreated"`
}

// NewCustomProtectionRule registers a new resource with the given unique name, arguments, and options.
func NewCustomProtectionRule(ctx *pulumi.Context,
	name string, args *CustomProtectionRuleArgs, opts ...pulumi.ResourceOption) (*CustomProtectionRule, error) {
	if args == nil {
		return nil, errors.New("missing one or more required arguments")
	}

	if args.CompartmentId == nil {
		return nil, errors.New("invalid value for required argument 'CompartmentId'")
	}
	if args.DisplayName == nil {
		return nil, errors.New("invalid value for required argument 'DisplayName'")
	}
	if args.Template == nil {
		return nil, errors.New("invalid value for required argument 'Template'")
	}
	opts = internal.PkgResourceDefaultOpts(opts)
	var resource CustomProtectionRule
	err := ctx.RegisterResource("oci:Waas/customProtectionRule:CustomProtectionRule", name, args, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// GetCustomProtectionRule gets an existing CustomProtectionRule resource's state with the given name, ID, and optional
// state properties that are used to uniquely qualify the lookup (nil if not required).
func GetCustomProtectionRule(ctx *pulumi.Context,
	name string, id pulumi.IDInput, state *CustomProtectionRuleState, opts ...pulumi.ResourceOption) (*CustomProtectionRule, error) {
	var resource CustomProtectionRule
	err := ctx.ReadResource("oci:Waas/customProtectionRule:CustomProtectionRule", name, id, state, &resource, opts...)
	if err != nil {
		return nil, err
	}
	return &resource, nil
}

// Input properties used for looking up and filtering CustomProtectionRule resources.
type customProtectionRuleState struct {
	// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
	CompartmentId *string `pulumi:"compartmentId"`
	// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
	DefinedTags map[string]interface{} `pulumi:"definedTags"`
	// (Updatable) A description for the Custom Protection rule.
	Description *string `pulumi:"description"`
	// (Updatable) A user-friendly name for the custom protection rule.
	DisplayName *string `pulumi:"displayName"`
	// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
	FreeformTags map[string]interface{} `pulumi:"freeformTags"`
	// The auto-generated ID for the custom protection rule. These IDs are referenced in logs.
	ModSecurityRuleIds []string `pulumi:"modSecurityRuleIds"`
	// The current lifecycle state of the custom protection rule.
	State *string `pulumi:"state"`
	// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
	//
	// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
	//
	// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
	//
	// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
	//
	// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
	//
	// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
	//
	// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
	//
	// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
	//
	// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	//
	// ** IMPORTANT **
	// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
	Template *string `pulumi:"template"`
	// The date and time the protection rule was created, expressed in RFC 3339 timestamp format.
	TimeCreated *string `pulumi:"timeCreated"`
}

type CustomProtectionRuleState struct {
	// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
	CompartmentId pulumi.StringPtrInput
	// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
	DefinedTags pulumi.MapInput
	// (Updatable) A description for the Custom Protection rule.
	Description pulumi.StringPtrInput
	// (Updatable) A user-friendly name for the custom protection rule.
	DisplayName pulumi.StringPtrInput
	// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
	FreeformTags pulumi.MapInput
	// The auto-generated ID for the custom protection rule. These IDs are referenced in logs.
	ModSecurityRuleIds pulumi.StringArrayInput
	// The current lifecycle state of the custom protection rule.
	State pulumi.StringPtrInput
	// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
	//
	// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
	//
	// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
	//
	// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
	//
	// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
	//
	// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
	//
	// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
	//
	// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
	//
	// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	//
	// ** IMPORTANT **
	// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
	Template pulumi.StringPtrInput
	// The date and time the protection rule was created, expressed in RFC 3339 timestamp format.
	TimeCreated pulumi.StringPtrInput
}

func (CustomProtectionRuleState) ElementType() reflect.Type {
	return reflect.TypeOf((*customProtectionRuleState)(nil)).Elem()
}

type customProtectionRuleArgs struct {
	// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
	CompartmentId string `pulumi:"compartmentId"`
	// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
	DefinedTags map[string]interface{} `pulumi:"definedTags"`
	// (Updatable) A description for the Custom Protection rule.
	Description *string `pulumi:"description"`
	// (Updatable) A user-friendly name for the custom protection rule.
	DisplayName string `pulumi:"displayName"`
	// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
	FreeformTags map[string]interface{} `pulumi:"freeformTags"`
	// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
	//
	// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
	//
	// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
	//
	// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
	//
	// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
	//
	// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
	//
	// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
	//
	// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
	//
	// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	//
	// ** IMPORTANT **
	// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
	Template string `pulumi:"template"`
}

// The set of arguments for constructing a CustomProtectionRule resource.
type CustomProtectionRuleArgs struct {
	// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
	CompartmentId pulumi.StringInput
	// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
	DefinedTags pulumi.MapInput
	// (Updatable) A description for the Custom Protection rule.
	Description pulumi.StringPtrInput
	// (Updatable) A user-friendly name for the custom protection rule.
	DisplayName pulumi.StringInput
	// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
	FreeformTags pulumi.MapInput
	// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
	//
	// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
	//
	// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
	//
	// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
	//
	// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
	//
	// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
	//
	// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
	//
	// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
	//
	// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
	//
	// ** IMPORTANT **
	// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
	Template pulumi.StringInput
}

func (CustomProtectionRuleArgs) ElementType() reflect.Type {
	return reflect.TypeOf((*customProtectionRuleArgs)(nil)).Elem()
}

type CustomProtectionRuleInput interface {
	pulumi.Input

	ToCustomProtectionRuleOutput() CustomProtectionRuleOutput
	ToCustomProtectionRuleOutputWithContext(ctx context.Context) CustomProtectionRuleOutput
}

func (*CustomProtectionRule) ElementType() reflect.Type {
	return reflect.TypeOf((**CustomProtectionRule)(nil)).Elem()
}

func (i *CustomProtectionRule) ToCustomProtectionRuleOutput() CustomProtectionRuleOutput {
	return i.ToCustomProtectionRuleOutputWithContext(context.Background())
}

func (i *CustomProtectionRule) ToCustomProtectionRuleOutputWithContext(ctx context.Context) CustomProtectionRuleOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CustomProtectionRuleOutput)
}

// CustomProtectionRuleArrayInput is an input type that accepts CustomProtectionRuleArray and CustomProtectionRuleArrayOutput values.
// You can construct a concrete instance of `CustomProtectionRuleArrayInput` via:
//
//	CustomProtectionRuleArray{ CustomProtectionRuleArgs{...} }
type CustomProtectionRuleArrayInput interface {
	pulumi.Input

	ToCustomProtectionRuleArrayOutput() CustomProtectionRuleArrayOutput
	ToCustomProtectionRuleArrayOutputWithContext(context.Context) CustomProtectionRuleArrayOutput
}

type CustomProtectionRuleArray []CustomProtectionRuleInput

func (CustomProtectionRuleArray) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*CustomProtectionRule)(nil)).Elem()
}

func (i CustomProtectionRuleArray) ToCustomProtectionRuleArrayOutput() CustomProtectionRuleArrayOutput {
	return i.ToCustomProtectionRuleArrayOutputWithContext(context.Background())
}

func (i CustomProtectionRuleArray) ToCustomProtectionRuleArrayOutputWithContext(ctx context.Context) CustomProtectionRuleArrayOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CustomProtectionRuleArrayOutput)
}

// CustomProtectionRuleMapInput is an input type that accepts CustomProtectionRuleMap and CustomProtectionRuleMapOutput values.
// You can construct a concrete instance of `CustomProtectionRuleMapInput` via:
//
//	CustomProtectionRuleMap{ "key": CustomProtectionRuleArgs{...} }
type CustomProtectionRuleMapInput interface {
	pulumi.Input

	ToCustomProtectionRuleMapOutput() CustomProtectionRuleMapOutput
	ToCustomProtectionRuleMapOutputWithContext(context.Context) CustomProtectionRuleMapOutput
}

type CustomProtectionRuleMap map[string]CustomProtectionRuleInput

func (CustomProtectionRuleMap) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*CustomProtectionRule)(nil)).Elem()
}

func (i CustomProtectionRuleMap) ToCustomProtectionRuleMapOutput() CustomProtectionRuleMapOutput {
	return i.ToCustomProtectionRuleMapOutputWithContext(context.Background())
}

func (i CustomProtectionRuleMap) ToCustomProtectionRuleMapOutputWithContext(ctx context.Context) CustomProtectionRuleMapOutput {
	return pulumi.ToOutputWithContext(ctx, i).(CustomProtectionRuleMapOutput)
}

type CustomProtectionRuleOutput struct{ *pulumi.OutputState }

func (CustomProtectionRuleOutput) ElementType() reflect.Type {
	return reflect.TypeOf((**CustomProtectionRule)(nil)).Elem()
}

func (o CustomProtectionRuleOutput) ToCustomProtectionRuleOutput() CustomProtectionRuleOutput {
	return o
}

func (o CustomProtectionRuleOutput) ToCustomProtectionRuleOutputWithContext(ctx context.Context) CustomProtectionRuleOutput {
	return o
}

// (Updatable) The [OCID](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/identifiers.htm) of the compartment in which to create the custom protection rule.
func (o CustomProtectionRuleOutput) CompartmentId() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.CompartmentId }).(pulumi.StringOutput)
}

// (Updatable) Defined tags for this resource. Each key is predefined and scoped to a namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Operations.CostCenter": "42"}`
func (o CustomProtectionRuleOutput) DefinedTags() pulumi.MapOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.MapOutput { return v.DefinedTags }).(pulumi.MapOutput)
}

// (Updatable) A description for the Custom Protection rule.
func (o CustomProtectionRuleOutput) Description() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.Description }).(pulumi.StringOutput)
}

// (Updatable) A user-friendly name for the custom protection rule.
func (o CustomProtectionRuleOutput) DisplayName() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.DisplayName }).(pulumi.StringOutput)
}

// (Updatable) Free-form tags for this resource. Each tag is a simple key-value pair with no predefined name, type, or namespace. For more information, see [Resource Tags](https://docs.cloud.oracle.com/iaas/Content/General/Concepts/resourcetags.htm).  Example: `{"Department": "Finance"}`
func (o CustomProtectionRuleOutput) FreeformTags() pulumi.MapOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.MapOutput { return v.FreeformTags }).(pulumi.MapOutput)
}

// The auto-generated ID for the custom protection rule. These IDs are referenced in logs.
func (o CustomProtectionRuleOutput) ModSecurityRuleIds() pulumi.StringArrayOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringArrayOutput { return v.ModSecurityRuleIds }).(pulumi.StringArrayOutput)
}

// The current lifecycle state of the custom protection rule.
func (o CustomProtectionRuleOutput) State() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.State }).(pulumi.StringOutput)
}

// (Updatable) The template text of the custom protection rule. All custom protection rules are expressed in ModSecurity Rule Language.
//
// Additionally, each rule must include two placeholder variables that are updated by the WAF service upon publication of the rule.
//
// `id: {{id_1}}` - This field is populated with a unique rule ID generated by the WAF service which identifies a `SecRule`. More than one `SecRule` can be defined in the `template` field of a CreateCustomSecurityRule call. The value of the first `SecRule` must be `id: {{id_1}}` and the `id` field of each subsequent `SecRule` should increase by one, as shown in the example.
//
// `ctl:ruleEngine={{mode}}` - The action to be taken when the criteria of the `SecRule` are met, either `OFF`, `DETECT` or `BLOCK`. This field is automatically populated with the corresponding value of the `action` field of the `CustomProtectionRuleSetting` schema when the `WafConfig` is updated.
//
// *Example:* ```SecRule REQUEST_COOKIES "regex matching SQL injection - part 1/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 1/2.',        \ id: {{id_1}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny" SecRule REQUEST_COOKIES "regex matching SQL injection - part 2/2" \ "phase:2,                                                 \ msg:'Detects chained SQL injection attempts 2/2.',        \ id: {{id_2}},                                             \ ctl:ruleEngine={{mode}},                                  \ deny"```
//
// The example contains two `SecRules` each having distinct regex expression to match the `Cookie` header value during the second input analysis phase.
//
// For more information about custom protection rules, see [Custom Protection Rules](https://docs.cloud.oracle.com/iaas/Content/WAF/tasks/customprotectionrules.htm).
//
// For more information about ModSecurity syntax, see [Making Rules: The Basic Syntax](https://www.modsecurity.org/CRS/Documentation/making.html).
//
// For more information about ModSecurity's open source WAF rules, see [Mod Security's OWASP Core Rule Set documentation](https://www.modsecurity.org/CRS/Documentation/index.html).
//
// ** IMPORTANT **
// Any change to a property that does not support update will force the destruction and recreation of the resource with the new property values
func (o CustomProtectionRuleOutput) Template() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.Template }).(pulumi.StringOutput)
}

// The date and time the protection rule was created, expressed in RFC 3339 timestamp format.
func (o CustomProtectionRuleOutput) TimeCreated() pulumi.StringOutput {
	return o.ApplyT(func(v *CustomProtectionRule) pulumi.StringOutput { return v.TimeCreated }).(pulumi.StringOutput)
}

type CustomProtectionRuleArrayOutput struct{ *pulumi.OutputState }

func (CustomProtectionRuleArrayOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*[]*CustomProtectionRule)(nil)).Elem()
}

func (o CustomProtectionRuleArrayOutput) ToCustomProtectionRuleArrayOutput() CustomProtectionRuleArrayOutput {
	return o
}

func (o CustomProtectionRuleArrayOutput) ToCustomProtectionRuleArrayOutputWithContext(ctx context.Context) CustomProtectionRuleArrayOutput {
	return o
}

func (o CustomProtectionRuleArrayOutput) Index(i pulumi.IntInput) CustomProtectionRuleOutput {
	return pulumi.All(o, i).ApplyT(func(vs []interface{}) *CustomProtectionRule {
		return vs[0].([]*CustomProtectionRule)[vs[1].(int)]
	}).(CustomProtectionRuleOutput)
}

type CustomProtectionRuleMapOutput struct{ *pulumi.OutputState }

func (CustomProtectionRuleMapOutput) ElementType() reflect.Type {
	return reflect.TypeOf((*map[string]*CustomProtectionRule)(nil)).Elem()
}

func (o CustomProtectionRuleMapOutput) ToCustomProtectionRuleMapOutput() CustomProtectionRuleMapOutput {
	return o
}

func (o CustomProtectionRuleMapOutput) ToCustomProtectionRuleMapOutputWithContext(ctx context.Context) CustomProtectionRuleMapOutput {
	return o
}

func (o CustomProtectionRuleMapOutput) MapIndex(k pulumi.StringInput) CustomProtectionRuleOutput {
	return pulumi.All(o, k).ApplyT(func(vs []interface{}) *CustomProtectionRule {
		return vs[0].(map[string]*CustomProtectionRule)[vs[1].(string)]
	}).(CustomProtectionRuleOutput)
}

func init() {
	pulumi.RegisterInputType(reflect.TypeOf((*CustomProtectionRuleInput)(nil)).Elem(), &CustomProtectionRule{})
	pulumi.RegisterInputType(reflect.TypeOf((*CustomProtectionRuleArrayInput)(nil)).Elem(), CustomProtectionRuleArray{})
	pulumi.RegisterInputType(reflect.TypeOf((*CustomProtectionRuleMapInput)(nil)).Elem(), CustomProtectionRuleMap{})
	pulumi.RegisterOutputType(CustomProtectionRuleOutput{})
	pulumi.RegisterOutputType(CustomProtectionRuleArrayOutput{})
	pulumi.RegisterOutputType(CustomProtectionRuleMapOutput{})
}
